# Stage 07: Refactoring Configuration

stage:
  id: "07-refactoring"
  name: "Refactoring"
  description: "ì½”ë“œ í’ˆì§ˆ ê°œì„  ë° ìµœì í™”"

models:
  primary: "codex"
  secondary: "claudecode"
  collaboration: "sequential"

# AI ìë™ í˜¸ì¶œ ì„¤ì • (Issue #12, #14 í•´ê²°)
auto_invoke:
  enabled: true
  model: "codex"
  trigger: "refactoring_start"
  prompt_file: "prompts/code_analysis.md"
  wrapper: "scripts/codex-wrapper.sh"
  flags: "--full-auto"
  required: true
  message: "ğŸ¤– Codex ìë™ í˜¸ì¶œ: ì½”ë“œ ë¶„ì„ ë° ë¦¬íŒ©í† ë§ ì‹œì‘"

execution:
  mode: "deep_dive"
  container: false
  sandbox: false
  timeout: 7200  # 2 hours

inputs:
  required:
    - name: "../06-implementation/outputs/source_code/"
    - name: "../06-implementation/outputs/implementation_log.md"
    - name: "../06-implementation/HANDOFF.md"

outputs:
  required:
    - name: "refactored_code/"
      description: "ë¦¬íŒ©í† ë§ëœ ì½”ë“œ"
    - name: "refactoring_report.md"
      description: "ë¦¬íŒ©í† ë§ ë³´ê³ ì„œ"
    - name: "HANDOFF.md"

prompts:
  - name: "code_analysis"
    file: "prompts/code_analysis.md"
    model: "codex"
  - name: "refactoring"
    file: "prompts/refactoring.md"
    model: "codex"
  - name: "optimization"
    file: "prompts/optimization.md"
    model: "codex"

completion:
  checklist:
    - "ì½”ë“œ í’ˆì§ˆ ë¶„ì„ ì™„ë£Œ"
    - "ì¤‘ë³µ ì½”ë“œ ì œê±°"
    - "ì„±ëŠ¥ ìµœì í™” ì ìš©"
    - "ë¦¬íŒ©í† ë§ ë³´ê³ ì„œ ì‘ì„±"
    - "ì²´í¬í¬ì¸íŠ¸ ìƒì„±"

transition:
  next_stage: "08-qa"
  prerequisites:
    - "06-implementation"
  handoff_required: true
  checkpoint_required: true  # í•„ìˆ˜!
